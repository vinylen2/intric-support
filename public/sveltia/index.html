<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sveltia CMS</title>
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
        background: #f5f5f5;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      }
      .sveltia-loading {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        color: #555;
      }
    </style>
  </head>
  <body>
    <div class="sveltia-loading">Loading Sveltia CMSâ€¦</div>
    <script type="module">
      const sources = [
        "/sveltia/sveltia-cms.js",
        "https://cdn.jsdelivr.net/npm/sveltia-cms@0.15.0/+esm",
        "https://esm.sh/sveltia-cms@0.15.0",
        "https://unpkg.com/sveltia-cms@0.15.0/dist/index.js?module"
      ];

      const loadCMS = async () => {
        for (const source of sources) {
          try {
            const module = await import(source);
            return module.default ?? module;
          } catch (error) {
            console.error(`Failed to load Sveltia CMS from ${source}`, error);
          }
        }
        throw new Error("Unable to load Sveltia CMS from any configured source.");
      };

      loadCMS()
        .then((SveltiaCMS) => {
          SveltiaCMS.init({
            configPath: "/admin/config.yml",
            workspaces: [
              {
                name: "default",
                label: "Default",
                configPath: "/admin/config.yml"
              }
            ]
          });
        })
        .catch((error) => {
          const loadingElement = document.querySelector(".sveltia-loading");
          if (loadingElement) {
            loadingElement.textContent =
              "Unable to load Sveltia CMS. Check the browser console for details.";
          }
          console.error(error);
        });
    </script>
  </body>
</html>
